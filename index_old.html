<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>伴学鸭聊天界面</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        }
        
        body {
            background-color: #F3F3F3;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMqADAAQAAAABAAAAMgAAAAB1y6+rAAABG0lEQVRoBe1XWwrDMAzLUXbLHb+LS1McNwR9GOQODUbjRtiSHw1pR2uftvnZfv9/q+M2Elp7i4htkiViUWNKUihBu/jUuKnOssmh/iRCM5F7PtmQlT/srO0Xhb9fnfsI6A1ib1WrhYl8g4htMSRiUVpKUihBu/jUuKnOssmh/iRCM5H7adfJHjuKPWORz2SzyVn8iVAwIH4QqDsujStNDk2eRIT+NZOSFErQbLESUaWdrj7Wnd0XhN2enstjzSZn8R+k3AuIHwTqTkvjSpNDkycRrnfHkpIUSlC0TVCcRIweck9WUnRnd0U4l6xKjLiRz2QPkD2njWCUxpUm1xMJ8YNAqDMWTiLC3JhJSQolaLZYiajSTlcf/8Wd/Qe3wZ32yy34pgAAAABJRU5ErkJggg==');
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: linear-gradient(to bottom right, #CCFF88, #F1FFD7);
        }
        
        .chat-container {
            width: 375px;
            height: 812px;
            background: linear-gradient(to bottom right, #CCFF88, #F1FFD7);
            border-radius: 33px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .chat-header {
            height: 60px;
            background-color: #51AE67;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: 500;
            border-radius: 33px 33px 0 0;
            position: relative;
            z-index: 2;
        }
        
        .chat-messages {
            height: calc(100% - 120px);
            overflow-y: auto;
            padding: 15px;
            padding-top: 80px; /* 为顶部固定思考框留出空间 */
        }
        
        .chat-input {
            height: 60px;
            position: absolute;
            bottom: 0;
            width: 100%;
            display: flex;
            align-items: center;
            padding: 0 15px;
            background-color: rgba(255, 255, 255, 0.8);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 0 0 33px 33px;
        }
        
        .input-field {
            flex: 1;
            height: 47px;
            border-radius: 23px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            background-color: white;
            padding: 0 15px;
            font-size: 16px;
            color: rgba(0, 0, 0, 0.5);
        }
        
        .message {
            max-width: 80%;
            margin-bottom: 20px;
            clear: both;
            animation: fadeIn 0.8s ease-in-out;
        }
        
        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 15px;
            line-height: 1.5;
        }
        
        .user-message {
            float: right;
            margin-left: 20%;
        }
        
        .user-message .message-content {
            background-color: #51AE67;
            color: white;
            border-radius: 18px 0 18px 18px;
        }
        
        .ai-message {
            float: left;
            margin-right: 20%;
        }
        
        .ai-message .message-content {
            background-color: white;
            color: #585858;
            border-radius: 0 18px 18px 18px;
        }
        
        /* 思考容器 - 灵动岛样式 */
        .thinking-container {
            position: absolute;
            top: 60px;
            left: 0;
            right: 0;
            z-index: 5;
            overflow: hidden;
            padding: 0 15px;
            transition: all 0.5s ease-in-out;
        }
        
        /* 完全展开状态 */
        .thinking-container.expanded {
            height: auto;
            max-height: 200px; /* 调整为更大的高度以显示所有内容 */
        }
        
        /* 灵动岛状态 */
        .thinking-container.collapsed {
            height: 40px;
            width: 100px; /* 灵动岛宽度 */
            left: 50%;
            transform: translateX(-50%);
            border-radius: 20px;
        }
        
        .thinking {
            background-color: rgba(1, 1, 1, 0.8);
            color: #94FAA1;
            padding: 15px;
            width: 100%;
            border-radius: 20px; /* 修复：确保上下圆角一致 */
            overflow: hidden;
        }
        
        .thinking-header {
            display: flex;
            align-items: center;
            height: 20px;
            position: relative;
        }
        
        .thinking-text {
            font-size: 16px;
            margin-right: 5px;
            white-space: nowrap;
        }
        
        .thinking-time {
            font-size: 16px;
            margin-right: 5px;
        }
        
        .thinking-content {
            font-size: 14px;
            opacity: 0.5;
            line-height: 1.6;
            margin-top: 10px;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 150px; /* 内容区域最大高度，允许滚动 */
        }
        
        /* 黑框中的可点击链接 */
        .data-link {
            color: #94FAA1 !important;
            text-decoration: underline;
            cursor: pointer;
            opacity: 1 !important;
            transition: all 0.2s;
        }
        
        .data-link:hover {
            color: #ffffff !important;
            opacity: 1 !important;
        }
        
        /* 灵动岛状态下隐藏内容和常规标题 */
        .thinking-container.collapsed .thinking-content,
        .thinking-container.collapsed .thinking-text,
        .thinking-container.collapsed .thinking-time,
        .thinking-container.collapsed .thinking-indicator {
            display: none;
        }
        
        /* 眼睛图标 - 只在收起状态显示 */
        .eyes {
            display: none;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .thinking-container.collapsed .eyes {
            display: flex;
        }
        
        .eye {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background-color: #94FAA1;
            margin: 0 5px;
            position: relative;
            overflow: hidden;
        }
        
        .pupil {
            width: 6px;
            height: 6px;
            background-color: #000;
            border-radius: 50%;
            position: absolute;
            top: 4px;
            left: 4px;
            animation: lookAround 3s infinite alternate;
        }
        
        @keyframes lookAround {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(2px, -1px); }
            50% { transform: translate(-1px, 1px); }
            75% { transform: translate(1px, 2px); }
        }
        
        .thinking-indicator {
            display: flex;
            margin-left: 10px;
        }
        
        .thinking-dot {
            width: 4px;
            height: 3px;
            background-color: #94FAA1;
            margin-right: 4px;
            opacity: 0.8;
            animation: blinkDot 1.5s infinite alternate;
        }

        .thinking-dot:nth-child(2) {
            animation-delay: 0.5s;
        }

        .thinking-dot:nth-child(3) {
            animation-delay: 1s;
        }
        
        .plan-card {
            clear: both;
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 20px;
            padding: 18px;
            margin: 25px 0;
            animation: fadeIn 0.8s ease-in-out;
        }
        
        .plan-title {
            font-size: 20px;
            color: #469337;
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .plan-date {
            font-size: 14px;
            color: #51AE67;
            margin-bottom: 20px;
        }
        
        .plan-item {
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .plan-item:hover {
            background-color: rgba(255, 255, 255, 0.6);
        }
        
        .plan-icon {
            width: 46px;
            height: 46px;
            background-color: white;
            border-radius: 23px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
        }
        
        .plan-icon svg {
            width: 24px;
            height: 24px;
        }
        
        .plan-details {
            flex: 1;
        }
        
        .plan-item-title {
            font-size: 16px;
            color: #585858;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .plan-item-subtitle {
            font-size: 12px;
            color: #868686;
        }
        
        .add-plan-btn {
            background-color: #51AE67;
            color: white;
            border-radius: 14px;
            padding: 15px;
            text-align: center;
            font-size: 16px;
            margin-top: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .add-plan-btn:hover {
            background-color: #469337;
        }
        
        /* 学习资料卡片样式 */
        .material-card {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 15px;
            margin: 15px 0;
            width: 90%;
            max-width: 300px;
            animation: fadeIn 0.8s ease-in-out;
            clear: both;
            float: left;
        }
        
        .material-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .material-icon {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
        }
        
        .video-icon {
            background-color: #FFF3F8;
        }
        
        .video-icon svg {
            fill: #DC74E9;
        }
        
        .exercise-icon {
            background-color: #EFF8FF;
        }
        
        .exercise-icon svg {
            fill: #2A95E7;
        }
        
        .material-title {
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }
        
        .material-total {
            font-size: 12px;
            color: #868686;
            margin-bottom: 12px;
        }
        
        .material-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            cursor: pointer;
            transition: background-color 0.2s;
            border-radius: 8px;
            padding-left: 5px;
        }
        
        .material-item:hover {
            background-color: rgba(0, 0, 0, 0.03);
        }
        
        .material-item-num {
            width: 22px;
            height: 22px;
            border-radius: 11px;
            font-size: 12px;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
        }
        
        .video-num {
            background-color: #DC74E9;
        }
        
        .exercise-num {
            background-color: #2A95E7;
        }
        
        .material-item-title {
            font-size: 14px;
            color: #333;
            flex: 1;
        }
        
        .material-item-duration {
            font-size: 12px;
            color: #868686;
        }
        
        .material-footer {
            display: flex;
            justify-content: flex-end;
            margin-top: 15px;
        }
        
        .material-more {
            font-size: 12px;
            color: #51AE67;
            cursor: pointer;
        }
        
        /* 预览窗口样式 */
        .preview-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .preview-container {
            width: 300px;
            height: 400px;
            background-color: white;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.4s ease-in-out;
        }
        
        .preview-header {
            padding: 20px;
            border-bottom: 2px solid #EEEEEE;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .preview-title {
            font-size: 18px;
            color: #469337;
            font-weight: 500;
        }
        
        .preview-close {
            width: 30px;
            height: 30px;
            border-radius: 15px;
            background-color: rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        
        .preview-close svg {
            width: 14px;
            height: 14px;
            stroke: #585858;
        }
        
        .preview-content {
            padding: 20px;
            overflow-y: auto;
            height: calc(100% - 65px);
        }
        
        .preview-section-title {
            font-size: 16px;
            color: #585858;
            margin-bottom: 15px;
        }
        
        .preview-item {
            background-color: rgba(243, 123, 48, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }
        
        .preview-item.active {
            background-color: rgba(243, 123, 48, 0.1);
        }
        
        .preview-item-date {
            display: inline-block;
            padding: 5px 10px;
            background-color: #F37B30;
            color: white;
            border-radius: 10px;
            font-size: 10px;
            margin-bottom: 10px;
        }
        
        .preview-item-title {
            font-size: 14px;
            color: #585858;
            margin-bottom: 5px;
        }
        
        .preview-item-info {
            font-size: 12px;
            color: #868686;
            margin-bottom: 10px;
        }
        
        .preview-item-action {
            text-align: right;
        }
        
        .preview-item-btn {
            display: inline-block;
            padding: 5px 15px;
            border: 1px solid #F37B30;
            color: #F37B30;
            border-radius: 10px;
            font-size: 12px;
            cursor: pointer;
        }
        
        /* 知识点表样式 */
        .knowledge-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .knowledge-table th {
            background-color: #EFF8FF;
            padding: 10px;
            text-align: left;
            border: 1px solid #ddd;
            color: #2A95E7;
        }
        
        .knowledge-table td {
            padding: 10px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .knowledge-table tr:nth-child(odd) {
            background-color: #f9f9f9;
        }
        
        /* 选项卡样式 - 修改为竖向排列 */
        .options-card {
            display: flex;
            flex-direction: column; /* 改为竖向排列 */
            background-color: white;
            border-radius: 12px;
            padding: 8px;
            margin: 10px 0;
            width: 120px; /* 调整宽度更适合竖向排列 */
        }
        
        .option {
            text-align: center;
            padding: 10px 0;
            border-radius: 8px;
            font-size: 14px;
            color: #51AE67;
            cursor: pointer;
            margin-bottom: 5px; /* 选项之间的间距 */
        }
        
        .option:last-child {
            margin-bottom: 0;
        }
        
        .option.selected {
            background-color: #51AE67;
            color: white;
            font-weight: 500;
        }
        
        /* 图片样式 */
        .chart-img {
            width: 100%;
            border-radius: 12px;
            margin: 10px 0;
            max-width: 280px;
            cursor: pointer; /* 添加可点击效果 */
            transition: transform 0.2s;
        }
        
        .chart-img:hover {
            transform: scale(1.02);
        }
        
        /* 表单样式 */
        .form-container {
            background-color: white;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            width: 100%;
        }
        
        .form-title {
            font-size: 16px;
            color: #51AE67;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            font-size: 14px;
            color: #585858;
            margin-bottom: 8px;
            display: block;
        }
        
        .radio-options {
            display: flex;
            justify-content: space-between;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
        }
        
        .radio-option input {
            margin-right: 5px;
        }
        
        .radio-option label {
            font-size: 12px;
            color: #585858;
        }
        
        .submit-btn {
            background-color: #51AE67;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            width: 100%;
            text-align: center;
            font-size: 14px;
            cursor: pointer;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes blinkDot {
            from { opacity: 0.3; }
            to { opacity: 0.8; }
        }
        
        /* 自定义滚动条 */
        .chat-messages::-webkit-scrollbar,
        .thinking-content::-webkit-scrollbar,
        .preview-content::-webkit-scrollbar {
            width: 5px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb,
        .thinking-content::-webkit-scrollbar-thumb,
        .preview-content::-webkit-scrollbar-thumb {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        
        .chat-messages::-webkit-scrollbar-track,
        .thinking-content::-webkit-scrollbar-track,
        .preview-content::-webkit-scrollbar-track {
            background-color: transparent;
        }
        
        /* 消息间的间隔时间标记 */
        .time-marker {
            text-align: center;
            margin: 20px 0;
            color: #868686;
            font-size: 12px;
            clear: both;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">伴学鸭</div>
        <div class="thinking-container collapsed" id="thinkingContainer">
            <div class="thinking">
                <div class="thinking-header">
                    <div class="thinking-text" id="thinkingType">思考中</div>
                    <div class="thinking-time" id="thinkingTime">0：01</div>
                    <div class="thinking-indicator">
                        <div class="thinking-dot"></div>
                        <div class="thinking-dot"></div>
                        <div class="thinking-dot"></div>
                    </div>
                    <!-- 添加眼睛图标 -->
                    <div class="eyes">
                        <div class="eye"><div class="pupil"></div></div>
                        <div class="eye"><div class="pupil"></div></div>
                    </div>
                </div>
                <div class="thinking-content" id="thinkingContent"></div>
            </div>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
            <input type="text" class="input-field" placeholder="给伴学鸭发送消息～">
        </div>
    </div>

    <!-- 预览窗口模板 - 电学模块知识点表 -->
    <template id="knowledgeTableTemplate">
        <div class="preview-overlay">
            <div class="preview-container">
                <div class="preview-header">
                    <div class="preview-title">电学模块细分知识点</div>
                    <div class="preview-close" id="closePreview">
                        <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6L6 18"></path>
                            <path d="M6 6L18 18"></path>
                        </svg>
                    </div>
                </div>
                <div class="preview-content">
                    <table class="knowledge-table">
                        <thead>
                            <tr>
                                <th>知识模块</th>
                                <th>细分知识点</th>
                                <th>考频</th>
                                <th>难度</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="3">电场</td>
                                <td>电场强度</td>
                                <td>高</td>
                                <td>中</td>
                            </tr>
                            <tr>
                                <td>电势能与电势</td>
                                <td>高</td>
                                <td>中</td>
                            </tr>
                            <tr>
                                <td>电场线分布</td>
                                <td>中</td>
                                <td>高</td>
                            </tr>
                            <tr>
                                <td rowspan="3">磁场</td>
                                <td>磁感线</td>
                                <td>中</td>
                                <td>中</td>
                            </tr>
                            <tr>
                                <td>安培力</td>
                                <td>高</td>
                                <td>中</td>
                            </tr>
                            <tr>
                                <td>洛伦兹力</td>
                                <td>高</td>
                                <td>高</td>
                            </tr>
                            <tr>
                                <td rowspan="3">电磁感应</td>
                                <td>法拉第电磁感应定律</td>
                                <td>高</td>
                                <td>中</td>
                            </tr>
                            <tr>
                                <td>楞次定律</td>
                                <td>高</td>
                                <td>高</td>
                            </tr>
                            <tr>
                                <td>自感与互感</td>
                                <td>中</td>
                                <td>高</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- 预览窗口模板 - 计划预览 -->
    <template id="planPreviewTemplate">
        <div class="preview-overlay">
            <div class="preview-container">
                <div class="preview-header">
                    <div class="preview-title">计划预览</div>
                    <div class="preview-close" id="closePlanPreview">
                        <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6L6 18"></path>
                            <path d="M6 6L18 18"></path>
                        </svg>
                    </div>
                </div>
                <div class="preview-content">
                    <div class="preview-section-title">讲义列表（共4套）</div>
                    
                    <div class="preview-item active">
                        <div class="preview-item-date">3/31-4/1</div>
                        <div class="preview-item-title">数列的定义与表示方法</div>
                        <div class="preview-item-info">共 2 页 | 难度：易</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">4/1-4/2</div>
                        <div class="preview-item-title">等差数列基本性质</div>
                        <div class="preview-item-info">共 3 页 | 难度：易</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">4/2-4/3</div>
                        <div class="preview-item-title">等比数列与通项公式</div>
                        <div class="preview-item-info">共 3 页 | 难度：易</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">4/3-4/4</div>
                        <div class="preview-item-title">数列求和公式与技巧</div>
                        <div class="preview-item-info">共 3 页 | 难度：易</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- 视频课预览模板 -->
    <template id="videoPreviewTemplate">
        <div class="preview-overlay">
            <div class="preview-container">
                <div class="preview-header">
                    <div class="preview-title">视频课程详情</div>
                    <div class="preview-close" id="closeVideoPreview">
                        <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6L6 18"></path>
                            <path d="M6 6L18 18"></path>
                        </svg>
                    </div>
                </div>
                <div class="preview-content">
                    <div class="preview-section-title">黄夫人物理课程</div>
                    
                    <div class="preview-item active">
                        <div class="preview-item-date">第一课</div>
                        <div class="preview-item-title">电场基本概念与规律</div>
                        <div class="preview-item-info">28分钟 | 难度：中等</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">播放</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">第二课</div>
                        <div class="preview-item-title">电场力与电势能</div>
                        <div class="preview-item-info">32分钟 | 难度：中等</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">播放</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">第三课</div>
                        <div class="preview-item-title">磁场与安培力</div>
                        <div class="preview-item-info">30分钟 | 难度：中等</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">播放</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">第四课</div>
                        <div class="preview-item-title">楞次定律详解</div>
                        <div class="preview-item-info">35分钟 | 难度：较难</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">播放</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- 练习题预览模板 -->
    <template id="exercisePreviewTemplate">
        <div class="preview-overlay">
            <div class="preview-container">
                <div class="preview-header">
                    <div class="preview-title">练习题详情</div>
                    <div class="preview-close" id="closeExercisePreview">
                        <svg viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 6L6 18"></path>
                            <path d="M6 6L18 18"></path>
                        </svg>
                    </div>
                </div>
                <div class="preview-content">
                    <div class="preview-section-title">电学专项练习</div>
                    
                    <div class="preview-item active">
                        <div class="preview-item-date">第一组</div>
                        <div class="preview-item-title">电场强度和电势专项</div>
                        <div class="preview-item-info">10题 | 难度：中等</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">第二组</div>
                        <div class="preview-item-title">磁场与安培力练习</div>
                        <div class="preview-item-info">12题 | 难度：中等</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">第三组</div>
                        <div class="preview-item-title">电磁感应综合题</div>
                        <div class="preview-item-info">15题 | 难度：较难</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                    
                    <div class="preview-item">
                        <div class="preview-item-date">第四组</div>
                        <div class="preview-item-title">电学实验专题</div>
                        <div class="preview-item-info">8题 | 难度：较易</div>
                        <div class="preview-item-action">
                            <div class="preview-item-btn">查看</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const thinkingContainer = document.getElementById('thinkingContainer');
        const thinkingContent = document.getElementById('thinkingContent');
        const thinkingTime = document.getElementById('thinkingTime');
        const thinkingType = document.getElementById('thinkingType');
        
        // 对话数据
        const conversation = [
            {
                type: 'thinking',
                content: '作为老师，我需要先快速定位学生的年级，才能匹配对应的备考策略。高三学生时间紧迫，需精准规划；高一高二则侧重基础巩固。学生回答前，我会预设他可能处于高三（因临近高考），但需确认。此外，用"鸭鸭"拉近距离，避免机械感，建立信任是后续辅导的基础。\n\n调取《各省高考时间表》确认当前备考阶段\n调取《学生年级-学习痛点对应表》预判需求'
            },
            {
                type: 'ai',
                content: '嗨同学！我是伴学鸭~你叫我鸭鸭就好！你现在上高几呀？',
                hasOptions: true
            },
            {
                type: 'user',
                content: '高三'
            },
            {
                type: 'thinking',
                content: '此时学生刚告知是高三，但尚未透露省份。作为老师，我需要立刻锁定省份信息，因为不同省份的高考卷差异巨大（如新课标Ⅰ卷、Ⅱ卷、自主命题）。\n\n目标1：快速判断学生所在省的高考政策（如赋分制、选考要求）和试卷结构（题量、题型）。\n\n目标2：通过省份关联一本线、物理单科分数线等数据，为后续制定目标提供依据。\n\n策略：用"奋斗"一词传递共情，避免直接提问的压迫感。\n\n预加载《全国各省高考物理考纲对比库》\n准备调用《省份-物理一本线映射表》（待学生回答后触发）'
            },
            {
                type: 'ai',
                content: '高三党不容易呀，还有几十天就高考了呢，你在哪个省奋斗呢？'
            },
            {
                type: 'user',
                content: '湖北'
            },
            {
                type: 'thinking',
                content: '通过"小伙伴"暗示群体共鸣，让学生感到模考崩溃是普遍现象，减轻自我怀疑。学生提到物理50分，需判断是基础漏洞（如公式不熟）还是应试技巧问题（如时间分配）。\n\n同时快速关联一本线：湖北物理一本线约65-70分，80分可冲重点大学。\n\n调取《湖北高三模考难度系数对比库》\n调取《物理50-80分提分案例库》中的速效方案'
            },
            {
                type: 'ai',
                content: '哎呀，鸭鸭的湖北小伙伴们都说最近的模考难度爆表呢，你感觉咋样？'
            },
            {
                type: 'user',
                content: '模考已崩，物理才50，我想上一本，啊啊啊啊啊.....'
            },
            {
                type: 'thinking',
                content: '学生目标一本，需计算总分缺口。假设湖北理科一本线约520分，若其他科总分450+，物理需70分；若其他科较弱，物理需80+。\n\n同时，强调"简单题不错+中档题90%"的战术，符合湖北卷特点（中档题占比60%）。\n\n调取《湖北近3年一本线及科目贡献值表》\n调取《物理题型分值分布图》确认简单/中档题占比'
            },
            {
                type: 'ai',
                content: '不慌，容鸭鸭帮你分析下局势，你其他科都怎么样啊，考一本你物理需要提升到多少？'
            },
            {
                type: 'user',
                content: '其他科倒还好，物理怎么也得冲到80分，现在完全没有思路怎么学。'
            },
            {
                type: 'thinking',
                content: '学生缺乏方向，需用数据让他看到"可操作性"。湖北物理高频考点明确（如动量守恒、电磁场复合题），集中突破这些模块效率最高。\n\n同时，避免让学生陷入"从头学"的误区，强调"考什么练什么"。\n\n调取《湖北物理题型分布表》\n调取《湖北物理难度分布表》\n调取《湖北物理考频统计表（2021-2024）》\n调取《高频考点-基础题对应题库》'
            },
            {
                type: 'ai',
                content: '好，明白了，鸭鸭先带你分析湖北省近4年的考卷哈，看完你就大概知道自己需要做什么了。\n\n首先，近四年的题型和难度分布如下：',
                hasChart: 'distribution'
            },
            {
                type: 'ai',
                content: '整体难度适中，以易错的中档题居多，你如果想拿80分的话，简单题不能错，中档题要答对90%，难题至少要拿10分。\n\n然后，我们看下不同模块的考频哈：',
                hasChart: 'frequency'
            },
            {
                type: 'ai',
                content: '⼒学模块功和能、动量是最热门考点，考频⾼达⼗次和⼋次；电磁学模块电场、磁场、电磁感应均出现过⼀年两考，需要重点关注；\n\n原⼦物理、热学、光学等选修模块每年⼀题，考查内容基本固定；万有引⼒、直线运动等⼒学基础知识模块内轮换考查，需要落实巩固。\n\n最后，物理各个模块的分值占比：',
                hasChart: 'score'
            },
            {
                type: 'thinking',
                content: '通过表单量化问题（如力学计算题失分率、电磁学选择题盲点），比口头描述更精准。同时，表单设计需隐含心理暗示：模块化拆分难点，让学生感觉"问题虽多，但个个可击破"。\n\n调取《学生学情诊断表模板》\n调取《薄弱点-专项训练题匹配库》'
            },
            {
                type: 'ai',
                content: '鸭鸭对你的情况还不太熟悉，能填一下这个表格让鸭鸭看看你的薄弱点在哪里吗？',
                hasForm: true
            },
            {
                type: 'user',
                content: '[填写表单：力学基础较好，电学基础薄弱]'
            },
            {
                type: 'thinking',
                content: '电学基础弱常表现为"电场线方向判断模糊""楞次定律应用生疏"。推荐黄夫人视频因他的"段子式教学"适合碎片化学习，且配套讲义题型与湖北卷吻合度高。\n\n强调"错题记录原因"而非单纯刷题，避免低效重复。\n\n调取《电学模块细分知识点表》\n调取《B站高赞物理课程评价库》筛选适配内容',
                showKnowledgeTable: true
            },
            {
                type: 'user',
                content: '[查看电学模块细分知识点表]'
            },
            {
                type: 'ai',
                content: '明白了，看来你力学学得不错，电学基础稍微差点儿哈，那我接下来多给你找点儿针对性的资料。\n\n前期的话你可以先练这份电学专题精选，搭配B站主播黄夫人的视频课，把所有的考点和题型熟悉一遍，在这个过程中要注重解题质量，每道错题都要记录错误的原因。',
                hasVideoCard: true
            },
            {
                type: 'thinking',
                content: '后期需训练"题感"，湖北卷物理常设置陷阱（如电磁学多过程问题），限时训练能暴露审题疏漏。\n\n真题需优先练本省卷，但全国卷中相似题型（如2022年全国Ⅰ卷第25题）可补充拓展。\n\n调取《湖北物理真题分类汇编》\n调取《高仿真模拟题难度评级表》'
            },
            {
                type: 'ai',
                content: '后期再练这份模拟题+真题汇编，掐时间来做，按照高考节奏来模拟练。',
                hasExerciseCard: true
            },
            {
                type: 'user',
                content: '好的，这些需要练多久呀，我还有80天就高考了。'
            },
            {
                type: 'ai',
                content: '你每天能花多少时间跟着我练呀。'
            },
            {
                type: 'user',
                content: '大概1-2小时吧。'
            },
            {
                type: 'thinking',
                content: '80天拆分为40天，符合"前紧后松"原则（考前20天需回归基础）。插入考试时间冲突时，自动减少当日任务量但延长后期训练，确保总进度不变。\n\n计划卡片需可视化（如甘特图），让学生有"掌控感"。\n\n调取《40天速提分计划模板库》\n调取《学生日程-学习计划自适应算法》'
            },
            {
                type: 'ai',
                content: '好那我给你定个40天的训练计划吧，前30天是模块训练，后10天是模拟练习，每天一个半小时，你看下可以不，如果你可以你就点添加计划，咱们从明天开始就可以训练了。'
            },
            {
                type: 'plan',
                title: '数列专项突破',
                date: '3月31日 - 4月4日 5 天完成',
                items: [
                    {
                        icon: 'video',
                        title: '视频课程【3节】',
                        subtitle: '每天1节 · 预计30分钟'
                    },
                    {
                        icon: 'notes',
                        title: '学习笔记【10页】',
                        subtitle: '每天2页 · 预计10分钟'
                    },
                    {
                        icon: 'exercises',
                        title: '练习题【30道】',
                        subtitle: '每天5道 · 预计30分钟',
                        showPreview: true
                    }
                ]
            },
            {
                type: 'user',
                content: '[查看练习题预览]'
            },
            {
                type: 'user',
                content: '鸭鸭，我4月23日到4月25日有考试，没法跟着学。'
            },
            {
                type: 'thinking',
                content: '学生临时反馈考试冲突（4.23-4.25），需在不影响整体提分节奏的前提下，动态调整计划。\n\n冲突影响分析：原计划是40天（含模块+模拟），扣除3天，剩余37天。需判断是"延长总周期"还是"压缩非核心模块"。\n\n优先级策略：学生薄弱点在电学，因此电学专题的20天训练时长不可压缩，而力学巩固部分（已掌握较好）可减少3天。\n\n心理适配：调整后计划需呈现"无缝衔接"感，避免学生因计划变动产生焦虑。技术上采用"时间平移+任务密度微调"，例如将原第15-18天的任务拆分为第15-19天，并降低每日题量5%。\n\n风险管控：检查调整后模拟考频率是否足够（至少5次），确保应试节奏不被打乱。'
            },
            {
                type: 'ai',
                content: '好，计划我已经调整完了'
            },
            {
                type: 'plan',
                title: '数列专项突破',
                date: '3月31日 - 4月4日 5 天完成',
                items: [
                    {
                        icon: 'video',
                        title: '视频课程【3节】',
                        subtitle: '每天1节 · 预计30分钟'
                    },
                    {
                        icon: 'notes',
                        title: '学习笔记【10页】',
                        subtitle: '每天2页 · 预计10分钟'
                    },
                    {
                        icon: 'exercises',
                        title: '练习题【30道】',
                        subtitle: '每天5道 · 预计30分钟'
                    }
                ]
            },
            {
                type: 'user',
                content: '厉害了，从明天开始执行！'
            },
            {
                type: 'ai',
                content: '加油哦，现在是考验你执行力的时候喽。'
            }
        ];
        
        // 显示思考状态（包含搜索内容）
        function showThinking(message) {
            return new Promise((resolve) => {
                // 设置思考类型
                thinkingType.textContent = '思考中';
                
                // 清空原有内容
                thinkingContent.textContent = '';
                
                // 展开思考框
                thinkingContainer.className = 'thinking-container expanded';
                
                // 模拟计时器
                let seconds = 1;
                const timerInterval = setInterval(() => {
                    seconds++;
                    let minutes = Math.floor(seconds / 60);
                    let remainSeconds = seconds % 60;
                    thinkingTime.textContent = `${minutes}：${remainSeconds < 10 ? '0' + remainSeconds : remainSeconds}`;
                }, 1000);
                
                // 逐字显示内容 - 降低速度
                let index = 0;
                const typeInterval = setInterval(() => {
                    if (index < message.content.length) {
                        thinkingContent.textContent += message.content[index];
                        index++;
                        // 保持滚动到底部
                        thinkingContent.scrollTop = thinkingContent.scrollHeight;
                    } else {
                        clearInterval(typeInterval);
                        
                        // 给所有的调取内容添加可点击样式
                        setTimeout(() => {
                            // 将所有的调取《xxx》模式改成链接样式
                            const content = thinkingContent.textContent;
                            let newContent = content.replace(/调取《(.*?)》/g, 
                                '调取<span class="data-link" data-table="$1">《$1》</span>');
                            
                            // 特殊处理电学模块细分知识点表，使其可点击
                            if (message.showKnowledgeTable) {
                                newContent = newContent.replace(
                                    /《电学模块细分知识点表》/g, 
                                    '<span class="data-link" id="knowledgeTableLink">《电学模块细分知识点表》</span>'
                                );
                            }
                            
                            thinkingContent.innerHTML = newContent;
                            
                            // 为所有数据链接添加点击事件
                            document.querySelectorAll('.data-link').forEach(link => {
                                if (link.id === 'knowledgeTableLink') {
                                    link.addEventListener('click', showKnowledgeTable);
                                } else {
                                    link.addEventListener('click', function() {
                                        const tableName = this.getAttribute('data-table');
                                        if (tableName.includes('视频') || tableName.includes('课程')) {
                                            showVideoPreview();
                                        } else if (tableName.includes('题') || tableName.includes('练习')) {
                                            showExercisePreview();
                                        } else {
                                            showInfoToast(`正在加载 ${tableName} 数据...`);
                                        }
                                    });
                                }
                            });
                        }, 500);
                        
                        // 等待一段时间后收起思考框为灵动岛
                        setTimeout(() => {
                            clearInterval(timerInterval);
                            thinkingContainer.className = 'thinking-container collapsed';
                            setTimeout(() => {
                                resolve();
                            }, 500); // 等待收起动画完成
                        }, 2000);
                    }
                }, 60); // 字符速度降低到60ms/字
            });
        }
        
        // 显示简单的提示信息
        function showInfoToast(message) {
            const toast = document.createElement('div');
            toast.style.position = 'fixed';
            toast.style.top = '20%';
            toast.style.left = '50%';
            toast.style.transform = 'translateX(-50%)';
            toast.style.padding = '10px 20px';
            toast.style.background = 'rgba(0,0,0,0.7)';
            toast.style.color = 'white';
            toast.style.borderRadius = '20px';
            toast.style.zIndex = '1000';
            toast.style.animation = 'fadeIn 0.3s, fadeOut 0.3s 1.7s';
            toast.style.animationFillMode = 'forwards';
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 2000);
        }
        
        // 显示AI消息
        function showAiMessage(message) {
            return new Promise((resolve) => {
                const messageElement = document.createElement('div');
                messageElement.className = 'message ai-message';
                
                const contentElement = document.createElement('div');
                contentElement.className = 'message-content';
                
                // 逐字显示内容 - 降低速度
                messageElement.appendChild(contentElement);
                chatMessages.appendChild(messageElement);
                
                let index = 0;
                const typeInterval = setInterval(() => {
                    if (index < message.content.length) {
                        contentElement.textContent += message.content[index];
                        index++;
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    } else {
                        clearInterval(typeInterval);
                        
                        // 检查是否需要添加附加内容
                        if (message.hasOptions) {
                            setTimeout(() => {
                                const optionsCard = createOptionsCard();
                                chatMessages.appendChild(optionsCard);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else if (message.hasChart === 'distribution') {
                            setTimeout(() => {
                                const chartContainer = document.createElement('div');
                                chartContainer.style.textAlign = 'center';
                                
                                // 添加题型分布图
                                const typeChart = document.createElement('img');
                                typeChart.className = 'chart-img';
                                typeChart.src = 'https://i.gsxcdn.com/2924568299_ctpwmdjv.png';
                                typeChart.alt = '题型分布图';
                                typeChart.addEventListener('click', () => showImagePreview(typeChart.src));
                                
                                // 添加难度分布图
                                const difficultyChart = document.createElement('img');
                                difficultyChart.className = 'chart-img';
                                difficultyChart.src = 'https://i.gsxcdn.com/2924334022_miwp2r1h.jpeg';
                                difficultyChart.alt = '难度分布图';
                                difficultyChart.addEventListener('click', () => showImagePreview(difficultyChart.src));
                                
                                chartContainer.appendChild(typeChart);
                                chartContainer.appendChild(difficultyChart);
                                
                                chatMessages.appendChild(chartContainer);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else if (message.hasChart === 'frequency') {
                            setTimeout(() => {
                                const chartContainer = document.createElement('div');
                                chartContainer.style.textAlign = 'center';
                                
                                const frequencyChart = document.createElement('img');
                                frequencyChart.className = 'chart-img';
                                frequencyChart.src = 'https://i.gsxcdn.com/2924334758_hq2rpx54.jpeg';
                                frequencyChart.alt = '知识点频率图';
                                frequencyChart.addEventListener('click', () => showImagePreview(frequencyChart.src));
                                
                                chartContainer.appendChild(frequencyChart);
                                
                                chatMessages.appendChild(chartContainer);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else if (message.hasChart === 'score') {
                            setTimeout(() => {
                                const chartContainer = document.createElement('div');
                                chartContainer.style.textAlign = 'center';
                                
                                const scoreChart = document.createElement('img');
                                scoreChart.className = 'chart-img';
                                scoreChart.src = 'https://i.gsxcdn.com/2924334752_z1k279rr.jpeg';
                                scoreChart.alt = '分值占比图';
                                scoreChart.addEventListener('click', () => showImagePreview(scoreChart.src));
                                
                                chartContainer.appendChild(scoreChart);
                                
                                chatMessages.appendChild(scoreChart);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else if (message.hasForm) {
                            setTimeout(() => {
                                const formContainer = createPhysicsForm();
                                chatMessages.appendChild(formContainer);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else if (message.hasVideoCard) {
                            setTimeout(() => {
                                const videoCard = createVideoCard();
                                chatMessages.appendChild(videoCard);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else if (message.hasExerciseCard) {
                            setTimeout(() => {
                                const exerciseCard = createExerciseCard();
                                chatMessages.appendChild(exerciseCard);
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                                setTimeout(resolve, 800);
                            }, 300);
                        } else {
                            setTimeout(resolve, 800);
                        }
                    }
                }, 40); // 字符速度降低到40ms/字
            });
        }
        
        // 显示大图预览
        function showImagePreview(src) {
            const overlay = document.createElement('div');
            overlay.className = 'preview-overlay';
            overlay.style.cursor = 'pointer';
            
            const img = document.createElement('img');
            img.src = src;
            img.style.maxWidth = '90%';
            img.style.maxHeight = '80%';
            img.style.borderRadius = '12px';
            
            overlay.appendChild(img);
            document.body.appendChild(overlay);
            
            overlay.addEventListener('click', function() {
                document.body.removeChild(overlay);
            });
        }
        
        // 创建选项卡 - 修改为竖向排列
        function createOptionsCard() {
            const optionsCard = document.createElement('div');
            optionsCard.className = 'options-card';
            
            const options = ['高一', '高二', '高三'];
            
            options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                
                // 设置高三为选中状态
                if (option === '高三') {
                    optionElement.classList.add('selected');
                }
                
                optionsCard.appendChild(optionElement);
            });
            
            return optionsCard;
        }
        
        // 创建视频课清单卡片
        function createVideoCard() {
            const materialCard = document.createElement('div');
            materialCard.className = 'material-card';
            
            const materialHeader = document.createElement('div');
            materialHeader.className = 'material-header';
            
            const materialIcon = document.createElement('div');
            materialIcon.className = 'material-icon video-icon';
            materialIcon.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z"/></svg>';
            
            const materialTitle = document.createElement('div');
            materialTitle.className = 'material-title';
            materialTitle.textContent = '视频课程清单';
            
            materialHeader.appendChild(materialIcon);
            materialHeader.appendChild(materialTitle);
            
            const materialTotal = document.createElement('div');
            materialTotal.className = 'material-total';
            materialTotal.textContent = '共6节课，总时长约180分钟';
            
            const videos = [
                { num: 1, title: '电场基本概念与规律', duration: '28分钟' },
                { num: 2, title: '电场力与电势能', duration: '32分钟' },
                { num: 3, title: '磁场与安培力', duration: '30分钟' },
                { num: 4, title: '楞次定律详解', duration: '35分钟' }
            ];
            
            const materialsContainer = document.createElement('div');
            
            videos.forEach(video => {
                const materialItem = document.createElement('div');
                materialItem.className = 'material-item';
                materialItem.addEventListener('click', showVideoPreview);
                
                const materialItemNum = document.createElement('div');
                materialItemNum.className = 'material-item-num video-num';
                materialItemNum.textContent = video.num;
                
                const materialItemTitle = document.createElement('div');
                materialItemTitle.className = 'material-item-title';
                materialItemTitle.textContent = video.title;
                
                const materialItemDuration = document.createElement('div');
                materialItemDuration.className = 'material-item-duration';
                materialItemDuration.textContent = video.duration;
                
                materialItem.appendChild(materialItemNum);
                materialItem.appendChild(materialItemTitle);
                materialItem.appendChild(materialItemDuration);
                
                materialsContainer.appendChild(materialItem);
            });
            
            const materialFooter = document.createElement('div');
            materialFooter.className = 'material-footer';
            
            const materialMore = document.createElement('div');
            materialMore.className = 'material-more';
            materialMore.textContent = '查看全部 >';
            materialMore.addEventListener('click', showVideoPreview);
            
            materialFooter.appendChild(materialMore);
            
            materialCard.appendChild(materialHeader);
            materialCard.appendChild(materialTotal);
            materialCard.appendChild(materialsContainer);
            materialCard.appendChild(materialFooter);
            
            return materialCard;
        }
        
        // 创建练习题清单卡片
        function createExerciseCard() {
            const materialCard = document.createElement('div');
            materialCard.className = 'material-card';
            
            const materialHeader = document.createElement('div');
            materialHeader.className = 'material-header';
            
            const materialIcon = document.createElement('div');
            materialIcon.className = 'material-icon exercise-icon';
            materialIcon.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24"><path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z"/></svg>';
            
            const materialTitle = document.createElement('div');
            materialTitle.className = 'material-title';
            materialTitle.textContent = '练习题清单';
            
            materialHeader.appendChild(materialIcon);
            materialHeader.appendChild(materialTitle);
            
            const materialTotal = document.createElement('div');
            materialTotal.className = 'material-total';
            materialTotal.textContent = '共50道题，包含选择题和计算题';
            
            const exercises = [
                { num: 1, title: '电场强度和电势专项', duration: '10题' },
                { num: 2, title: '磁场与安培力练习', duration: '12题' },
                { num: 3, title: '电磁感应综合题', duration: '15题' },
                { num: 4, title: '电学实验专题', duration: '8题' }
            ];
            
            const materialsContainer = document.createElement('div');
            
            exercises.forEach(exercise => {
                const materialItem = document.createElement('div');
                materialItem.className = 'material-item';
                materialItem.addEventListener('click', showExercisePreview);
                
                const materialItemNum = document.createElement('div');
                materialItemNum.className = 'material-item-num exercise-num';
                materialItemNum.textContent = exercise.num;
                
                const materialItemTitle = document.createElement('div');
                materialItemTitle.className = 'material-item-title';
                materialItemTitle.textContent = exercise.title;
                
                const materialItemDuration = document.createElement('div');
                materialItemDuration.className = 'material-item-duration';
                materialItemDuration.textContent = exercise.duration;
                
                materialItem.appendChild(materialItemNum);
                materialItem.appendChild(materialItemTitle);
                materialItem.appendChild(materialItemDuration);
                
                materialsContainer.appendChild(materialItem);
            });
            
            const materialFooter = document.createElement('div');
            materialFooter.className = 'material-footer';
            
            const materialMore = document.createElement('div');
            materialMore.className = 'material-more';
            materialMore.textContent = '查看全部 >';
            materialMore.addEventListener('click', showExercisePreview);
            
            materialFooter.appendChild(materialMore);
            
            materialCard.appendChild(materialHeader);
            materialCard.appendChild(materialTotal);
            materialCard.appendChild(materialsContainer);
            materialCard.appendChild(materialFooter);
            
            return materialCard;
        }
        
        // 创建物理学科表单
        function createPhysicsForm() {
            const formContainer = document.createElement('div');
            formContainer.className = 'form-container';
            
            const formTitle = document.createElement('div');
            formTitle.className = 'form-title';
            formTitle.textContent = '物理学习情况调查表';
            formContainer.appendChild(formTitle);
            
            const modules = [
                '力学模块',
                '电磁学模块',
                '选修模块',
                '实验模块',
                '计算模块'
            ];
            
            const options = [
                '一般不会错',
                '偶尔错',
                '经常错'
            ];
            
            modules.forEach(module => {
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group';
                
                const formLabel = document.createElement('div');
                formLabel.className = 'form-label';
                formLabel.textContent = module;
                formGroup.appendChild(formLabel);
                
                const radioOptions = document.createElement('div');
                radioOptions.className = 'radio-options';
                
                options.forEach((option, index) => {
                    const radioOption = document.createElement('div');
                    radioOption.className = 'radio-option';
                    
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = module;
                    radioInput.id = `${module}-${index}`;
                    
                    // 力学基础较好，电学基础薄弱
                    if (module === '力学模块' && option === '一般不会错') {
                        radioInput.checked = true;
                    } else if (module === '电磁学模块' && option === '经常错') {
                        radioInput.checked = true;
                    } else if (option === '偶尔错') {
                        radioInput.checked = true;
                    }
                    
                    const radioLabel = document.createElement('label');
                    radioLabel.htmlFor = `${module}-${index}`;
                    radioLabel.textContent = option;
                    
                    radioOption.appendChild(radioInput);
                    radioOption.appendChild(radioLabel);
                    radioOptions.appendChild(radioOption);
                });
                
                formGroup.appendChild(radioOptions);
                formContainer.appendChild(formGroup);
            });
            
            const submitBtn = document.createElement('button');
            submitBtn.className = 'submit-btn';
            submitBtn.textContent = '提交';
            formContainer.appendChild(submitBtn);
            
            return formContainer;
        }
        
        // 显示用户消息
        function showUserMessage(content) {
            return new Promise((resolve) => {
                const messageElement = document.createElement('div');
                messageElement.className = 'message user-message';
                
                const contentElement = document.createElement('div');
                contentElement.className = 'message-content';
                contentElement.textContent = content;
                
                // 检查是否是特殊消息类型
                if (content === '[查看电学模块细分知识点表]') {
                    showKnowledgeTable();
                    // 延迟一会再显示消息，让预览窗口先显示
                    setTimeout(() => {
                        messageElement.appendChild(contentElement);
                        chatMessages.appendChild(messageElement);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                                                resolve();
                    }, 500);
                } else if (content === '[查看练习题预览]') {
                    showExercisePreview();
                    setTimeout(() => {
                        messageElement.appendChild(contentElement);
                        chatMessages.appendChild(messageElement);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                        resolve();
                    }, 500);
                } else {
                    messageElement.appendChild(contentElement);
                    chatMessages.appendChild(messageElement);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    resolve();
                }
            });
        }
        
        // 显示计划卡片
        function showPlanCard(message) {
            return new Promise((resolve) => {
                const planCard = document.createElement('div');
                planCard.className = 'plan-card';
                
                const planHeader = document.createElement('div');
                planHeader.className = 'plan-header';
                
                const planTitle = document.createElement('div');
                planTitle.className = 'plan-title';
                planTitle.textContent = message.title;
                
                const planDate = document.createElement('div');
                planDate.className = 'plan-date';
                planDate.textContent = message.date;
                
                planHeader.appendChild(planTitle);
                planHeader.appendChild(planDate);
                
                const planContent = document.createElement('div');
                planContent.className = 'plan-content';
                
                message.items.forEach(item => {
                    const planItem = document.createElement('div');
                    planItem.className = 'plan-item';
                    
                    const planItemIcon = document.createElement('div');
                    planItemIcon.className = `plan-item-icon ${item.icon}-icon`;
                    
                    if (item.icon === 'video') {
                        planItemIcon.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z"/></svg>';
                    } else if (item.icon === 'notes') {
                        planItemIcon.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24"><path d="M14,10H19.5L14,4.5V10M5,3H15L21,9V19A2,2 0 0,1 19,21H5C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3M5,5V19H19V12H12V5H5Z"/></svg>';
                    } else if (item.icon === 'exercises') {
                        planItemIcon.innerHTML = '<svg viewBox="0 0 24 24" width="24" height="24"><path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z"/></svg>';
                    }
                    
                    const planItemContent = document.createElement('div');
                    planItemContent.className = 'plan-item-content';
                    
                    const planItemTitle = document.createElement('div');
                    planItemTitle.className = 'plan-item-title';
                    planItemTitle.textContent = item.title;
                    
                    const planItemSubtitle = document.createElement('div');
                    planItemSubtitle.className = 'plan-item-subtitle';
                    planItemSubtitle.textContent = item.subtitle;
                    
                    planItemContent.appendChild(planItemTitle);
                    planItemContent.appendChild(planItemSubtitle);
                    
                    planItem.appendChild(planItemIcon);
                    planItem.appendChild(planItemContent);
                    
                    // 如果是练习题，添加预览按钮
                    if (item.showPreview) {
                        const previewBtn = document.createElement('div');
                        previewBtn.className = 'preview-btn';
                        previewBtn.textContent = '预览';
                        previewBtn.addEventListener('click', showExercisePreview);
                        
                        planItem.appendChild(previewBtn);
                    }
                    
                    planContent.appendChild(planItem);
                });
                
                const planFooter = document.createElement('div');
                planFooter.className = 'plan-footer';
                
                const addPlanBtn = document.createElement('button');
                addPlanBtn.className = 'add-plan-btn';
                addPlanBtn.textContent = '添加到日程';
                addPlanBtn.addEventListener('click', () => {
                    showInfoToast('计划已添加到你的学习日程！');
                });
                
                planFooter.appendChild(addPlanBtn);
                
                planCard.appendChild(planHeader);
                planCard.appendChild(planContent);
                planCard.appendChild(planFooter);
                
                chatMessages.appendChild(planCard);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                resolve();
            });
        }
        
        // 显示电学模块细分知识点表
        function showKnowledgeTable() {
            const previewOverlay = document.createElement('div');
            previewOverlay.className = 'preview-overlay';
            
            const previewWindow = document.createElement('div');
            previewWindow.className = 'preview-window knowledge-table-preview';
            
            const previewHeader = document.createElement('div');
            previewHeader.className = 'preview-header';
            
            const previewTitle = document.createElement('div');
            previewTitle.className = 'preview-title';
            previewTitle.textContent = '电学模块细分知识点表';
            
            const closeBtn = document.createElement('div');
            closeBtn.className = 'preview-close';
            closeBtn.innerHTML = '×';
            closeBtn.addEventListener('click', () => {
                document.body.removeChild(previewOverlay);
            });
            
            previewHeader.appendChild(previewTitle);
            previewHeader.appendChild(closeBtn);
            
            const previewContent = document.createElement('div');
            previewContent.className = 'preview-content';
            
            // 添加知识点表内容
            const knowledgeTable = document.createElement('div');
            knowledgeTable.className = 'knowledge-table';
            
            const knowledgeModules = [
                {
                    title: '静电场',
                    topics: [
                        '库仑定律与电场强度',
                        '电场线与电势能',
                        '电势与等势面',
                        '电容器结构与电容'
                    ],
                    importance: '高频',
                    difficulty: '中等'
                },
                {
                    title: '恒定电流',
                    topics: [
                        '欧姆定律与电阻',
                        '电功率与焦耳定律',
                        '电路的串并联',
                        '电源电动势与内阻'
                    ],
                    importance: '高频',
                    difficulty: '中低'
                },
                {
                    title: '磁场',
                    topics: [
                        '磁感应强度的概念',
                        '安培力与洛伦兹力',
                        '带电粒子在磁场中的运动',
                        '磁通量与高斯定理'
                    ],
                    importance: '高频',
                    difficulty: '较高'
                },
                {
                    title: '电磁感应',
                    topics: [
                        '法拉第电磁感应定律',
                        '楞次定律与感应电流方向',
                        '自感与互感',
                        '涡流与电磁制动'
                    ],
                    importance: '高频',
                    difficulty: '较高'
                },
                {
                    title: '电磁波',
                    topics: [
                        '电磁波的产生与传播',
                        '电磁波谱',
                        '电磁波的基本性质',
                        '电磁波的应用'
                    ],
                    importance: '中频',
                    difficulty: '中等'
                }
            ];
            
            // 创建表格
            const table = document.createElement('table');
            table.className = 'knowledge-detail-table';
            
            // 创建表头
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            
            const headers = ['模块', '细分知识点', '重要程度', '难度'];
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // 创建表格内容
            const tbody = document.createElement('tbody');
            
            knowledgeModules.forEach(module => {
                const row = document.createElement('tr');
                
                const moduleCell = document.createElement('td');
                moduleCell.textContent = module.title;
                moduleCell.rowSpan = module.topics.length;
                row.appendChild(moduleCell);
                
                const topicCell = document.createElement('td');
                topicCell.textContent = module.topics[0];
                row.appendChild(topicCell);
                
                const importanceCell = document.createElement('td');
                importanceCell.textContent = module.importance;
                importanceCell.rowSpan = module.topics.length;
                row.appendChild(importanceCell);
                
                const difficultyCell = document.createElement('td');
                difficultyCell.textContent = module.difficulty;
                difficultyCell.rowSpan = module.topics.length;
                row.appendChild(difficultyCell);
                
                tbody.appendChild(row);
                
                // 添加剩余的知识点行
                for (let i = 1; i < module.topics.length; i++) {
                    const subRow = document.createElement('tr');
                    
                    const subTopicCell = document.createElement('td');
                    subTopicCell.textContent = module.topics[i];
                    subRow.appendChild(subTopicCell);
                    
                    tbody.appendChild(subRow);
                }
            });
            
            table.appendChild(tbody);
            knowledgeTable.appendChild(table);
            
            // 学习建议
            const suggestionsTitle = document.createElement('h3');
            suggestionsTitle.textContent = '学习建议';
            
            const suggestionsList = document.createElement('ul');
            const suggestions = [
                '优先掌握"高频"标记的知识点，特别是静电场和电磁感应',
                '对于"难度较高"的模块，建议配合视频学习，尤其是楞次定律应用',
                '电路分析部分重点练习复杂电路的简化方法',
                '磁场部分要注重右手定则的灵活应用和判断',
                '对电磁波部分，重点掌握基本概念，不要深入太多细节'
            ];
            
            suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                suggestionsList.appendChild(li);
            });
            
            knowledgeTable.appendChild(suggestionsTitle);
            knowledgeTable.appendChild(suggestionsList);
            
            previewContent.appendChild(knowledgeTable);
            
            previewWindow.appendChild(previewHeader);
            previewWindow.appendChild(previewContent);
            
            previewOverlay.appendChild(previewWindow);
            document.body.appendChild(previewOverlay);
        }
        
        // 显示视频预览窗口
        function showVideoPreview() {
            const previewOverlay = document.createElement('div');
            previewOverlay.className = 'preview-overlay';
            
            const previewWindow = document.createElement('div');
            previewWindow.className = 'preview-window video-preview';
            
            const previewHeader = document.createElement('div');
            previewHeader.className = 'preview-header';
            
            const previewTitle = document.createElement('div');
            previewTitle.className = 'preview-title';
            previewTitle.textContent = '电学基础视频课程';
            
            const closeBtn = document.createElement('div');
            closeBtn.className = 'preview-close';
            closeBtn.innerHTML = '×';
            closeBtn.addEventListener('click', () => {
                document.body.removeChild(previewOverlay);
            });
            
            previewHeader.appendChild(previewTitle);
            previewHeader.appendChild(closeBtn);
            
            const previewContent = document.createElement('div');
            previewContent.className = 'preview-content';
            
            // 视频播放器容器
            const videoPlayer = document.createElement('div');
            videoPlayer.className = 'video-player';
            
            const videoPlaceholder = document.createElement('div');
            videoPlaceholder.className = 'video-placeholder';
            videoPlaceholder.textContent = '电场基本概念与规律（视频播放界面）';
            
            videoPlayer.appendChild(videoPlaceholder);
            
            // 视频列表
            const videoList = document.createElement('div');
            videoList.className = 'video-list';
            
            const videos = [
                { num: 1, title: '电场基本概念与规律', duration: '28分钟', active: true },
                { num: 2, title: '电场力与电势能', duration: '32分钟' },
                { num: 3, title: '磁场与安培力', duration: '30分钟' },
                { num: 4, title: '楞次定律详解', duration: '35分钟' },
                { num: 5, title: '电磁波基础', duration: '25分钟' },
                { num: 6, title: '电路分析方法', duration: '30分钟' }
            ];
            
            videos.forEach(video => {
                const videoItem = document.createElement('div');
                videoItem.className = `video-item ${video.active ? 'active' : ''}`;
                
                const videoNum = document.createElement('div');
                videoNum.className = 'video-num';
                videoNum.textContent = video.num;
                
                const videoInfo = document.createElement('div');
                videoInfo.className = 'video-info';
                
                const videoTitle = document.createElement('div');
                videoTitle.className = 'video-title';
                videoTitle.textContent = video.title;
                
                const videoDuration = document.createElement('div');
                videoDuration.className = 'video-duration';
                videoDuration.textContent = video.duration;
                
                videoInfo.appendChild(videoTitle);
                videoInfo.appendChild(videoDuration);
                
                videoItem.appendChild(videoNum);
                videoItem.appendChild(videoInfo);
                
                videoItem.addEventListener('click', () => {
                    // 移除其他项目的活动状态
                    document.querySelectorAll('.video-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // 添加当前项目的活动状态
                    videoItem.classList.add('active');
                    
                    // 更新视频播放器
                    videoPlaceholder.textContent = `${video.title}（视频播放界面）`;
                });
                
                videoList.appendChild(videoItem);
            });
            
            previewContent.appendChild(videoPlayer);
            previewContent.appendChild(videoList);
            
            previewWindow.appendChild(previewHeader);
            previewWindow.appendChild(previewContent);
            
            previewOverlay.appendChild(previewWindow);
            document.body.appendChild(previewOverlay);
        }
        
        // 显示练习题预览窗口
        function showExercisePreview() {
            const previewOverlay = document.createElement('div');
            previewOverlay.className = 'preview-overlay';
            
            const previewWindow = document.createElement('div');
            previewWindow.className = 'preview-window exercise-preview';
            
            const previewHeader = document.createElement('div');
            previewHeader.className = 'preview-header';
            
            const previewTitle = document.createElement('div');
            previewTitle.className = 'preview-title';
            previewTitle.textContent = '电学模块练习题';
            
            const closeBtn = document.createElement('div');
            closeBtn.className = 'preview-close';
            closeBtn.innerHTML = '×';
            closeBtn.addEventListener('click', () => {
                document.body.removeChild(previewOverlay);
            });
            
            previewHeader.appendChild(previewTitle);
            previewHeader.appendChild(closeBtn);
            
            const previewContent = document.createElement('div');
            previewContent.className = 'preview-content';
            
            // 练习题面板
            const exerciseContainer = document.createElement('div');
            exerciseContainer.className = 'exercise-container';
            
            const exerciseNav = document.createElement('div');
            exerciseNav.className = 'exercise-nav';
            
            // 练习题导航栏
            const prevBtn = document.createElement('button');
            prevBtn.className = 'nav-btn prev-btn';
            prevBtn.innerHTML = '< 上一题';
            prevBtn.disabled = true;
            
            const progressInfo = document.createElement('div');
            progressInfo.className = 'progress-info';
            progressInfo.textContent = '1/30';
            
            const nextBtn = document.createElement('button');
            nextBtn.className = 'nav-btn next-btn';
            nextBtn.innerHTML = '下一题 >';
            
            exerciseNav.appendChild(prevBtn);
            exerciseNav.appendChild(progressInfo);
            exerciseNav.appendChild(nextBtn);
            
            // 练习题内容
            const exerciseContent = document.createElement('div');
            exerciseContent.className = 'exercise-content';
            
            const exerciseTitle = document.createElement('div');
            exerciseTitle.className = 'exercise-title';
            exerciseTitle.innerHTML = `<span class="exercise-number">1.</span> 如图所示，一个带点粒子进入匀强磁场区域，速度垂直于磁场方向，粒子在磁场中做圆周运动，下列说法正确的是：`;
            
            const exerciseImage = document.createElement('div');
            exerciseImage.className = 'exercise-image';
            exerciseImage.innerHTML = `<svg width="300" height="200" viewBox="0 0 300 200">
                <rect x="50" y="50" width="200" height="100" fill="none" stroke="#666" stroke-dasharray="5,5"/>
                <text x="150" y="100" text-anchor="middle" fill="#666">匀强磁场区域</text>
                <circle cx="120" cy="100" r="40" fill="none" stroke="#333" stroke-width="2"/>
                <path d="M 120 60 A 40 40 0 0 1 160 100" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
                    </marker>
                </defs>
            </svg>`;
            
            const exerciseOptions = document.createElement('div');
            exerciseOptions.className = 'exercise-options';
            
            const options = [
                'A. 粒子的动能保持不变',
                'B. 粒子做匀减速圆周运动',
                'C. 粒子的机械能逐渐减小',
                'D. 磁场力改变了粒子的速度大小'
            ];
            
            options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'exercise-option';
                
                const radioInput = document.createElement('input');
                radioInput.type = 'radio';
                radioInput.name = 'exercise1';
                radioInput.id = `option${index}`;
                
                const optionLabel = document.createElement('label');
                optionLabel.htmlFor = `option${index}`;
                optionLabel.textContent = option;
                
                optionElement.appendChild(radioInput);
                optionElement.appendChild(optionLabel);
                exerciseOptions.appendChild(optionElement);
            });
            
            const submitBtn = document.createElement('button');
            submitBtn.className = 'submit-exercise-btn';
            submitBtn.textContent = '提交答案';
            submitBtn.addEventListener('click', () => {
                const selectedOption = document.querySelector('input[name="exercise1"]:checked');
                if (selectedOption) {
                    if (selectedOption.id === 'option0') { // A选项是正确答案
                        showInfoToast('回答正确！');
                        
                        // 显示解析
                        const explanationElement = document.createElement('div');
                        explanationElement.className = 'exercise-explanation';
                        explanationElement.innerHTML = `
                            <div class="explanation-title">解析：</div>
                            <div class="explanation-content">
                                带电粒子在匀强磁场中做圆周运动时，磁场力始终垂直于运动方向，因此只改变速度方向而不改变速度大小，所以动能保持不变。磁场力不做功，粒子的机械能不变。所以选A。
                            </div>
                        `;
                        
                        // 检查是否已经有解析
                        if (!document.querySelector('.exercise-explanation')) {
                            exerciseContent.appendChild(explanationElement);
                        }
                    } else {
                        showInfoToast('回答错误，请再试一次！');
                    }
                } else {
                    showInfoToast('请选择一个选项！');
                }
            });
            
            exerciseContent.appendChild(exerciseTitle);
            exerciseContent.appendChild(exerciseImage);
            exerciseContent.appendChild(exerciseOptions);
            exerciseContent.appendChild(submitBtn);
            
            exerciseContainer.appendChild(exerciseNav);
            exerciseContainer.appendChild(exerciseContent);
            
            // 侧边栏：题目列表
            const exerciseList = document.createElement('div');
            exerciseList.className = 'exercise-list';
            
            const listTitle = document.createElement('div');
            listTitle.className = 'list-title';
            listTitle.textContent = '题目列表';
            
            const questionsList = document.createElement('div');
            questionsList.className = 'questions-list';
            
            for (let i = 1; i <= 30; i++) {
                const questionItem = document.createElement('div');
                questionItem.className = `question-item ${i === 1 ? 'active' : ''}`;
                questionItem.textContent = i;
                
                questionItem.addEventListener('click', () => {
                    // 更新当前活动题目
                    document.querySelectorAll('.question-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    questionItem.classList.add('active');
                    
                    // 更新进度信息
                    progressInfo.textContent = `${i}/30`;
                    
                    // 启用/禁用导航按钮
                    prevBtn.disabled = i === 1;
                    nextBtn.disabled = i === 30;
                    
                    // 如果不是第一题，则假设内容不同
                    if (i !== 1) {
                        exerciseTitle.innerHTML = `<span class="exercise-number">${i}.</span> 这是第 ${i} 题的题目内容，与电学模块相关...`;
                        
                        // 清除之前的选择和解析
                        document.querySelectorAll('input[name="exercise1"]').forEach(input => {
                            input.checked = false;
                        });
                        
                        const explanation = document.querySelector('.exercise-explanation');
                        if (explanation) {
                            exerciseContent.removeChild(explanation);
                        }
                    }
                });
                
                questionsList.appendChild(questionItem);
            }
            
            exerciseList.appendChild(listTitle);
            exerciseList.appendChild(questionsList);
            
            previewContent.appendChild(exerciseContainer);
            previewContent.appendChild(exerciseList);
            
            previewWindow.appendChild(previewHeader);
            previewWindow.appendChild(previewContent);
            
            previewOverlay.appendChild(previewWindow);
            document.body.appendChild(previewOverlay);
        }
        
        // 主函数：按顺序渲染对话
        async function renderConversation() {
            for (let i = 0; i < conversation.length; i++) {
                const message = conversation[i];
                
                if (message.type === 'thinking') {
                    await showThinking(message);
                } else if (message.type === 'ai') {
                    await showAiMessage(message);
                } else if (message.type === 'user') {
                    await showUserMessage(message.content);
                } else if (message.type === 'plan') {
                    await showPlanCard(message);
                }
            }
        }
        
        // 页面加载完成后开始渲染对话
        window.addEventListener('load', renderConversation);
    </script>
</body>
</html>